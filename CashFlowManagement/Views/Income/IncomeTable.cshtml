@model CashFlowManagement.ViewModels.IncomeListViewModel
@using CashFlowManagement.Constants
@using CashFlowManagement.Utilities
@using CashFlowManagement.EntityModel
@{
    ViewBag.Title = "IncomeTable";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@{
    string title = string.Empty;
    string type = string.Empty;
    if (Model.Type == (int)Constants.INCOME_TYPE.SALARY_INCOME)
    {
        title = "Thu nhập từ lương";
    }
}

@*<ol class="breadcrumb">
    <li class="active">@title</li>
</ol>*@
<div class="clear10"></div>
<div class="row background">
    <div class="col-md-12">
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#create-new-income-modal">
            <span class="glyphicon glyphicon-plus"></span>
            @if (Model.Type == (int)Constants.INCOME_TYPE.SALARY_INCOME)
            {
                @Html.Raw("Tạo mới")
            }
        </button>
    </div>
    <div class="clear10"></div>
    <div class="asset-table col-md-12">
        <table class="table table-bordered table-condensed table-responsive">
            <thead>
                <tr>
                    @if (Model.Type == (int)Constants.INCOME_TYPE.SALARY_INCOME)
                    {
                        <th class="text-left">Thu nhập từ lương</th>
                        <th class="text-right">Ngày nhận lương hàng tháng</th>
                        <th class="text-right">Tháng bắt đầu</th>
                        <th class="text-right">Tháng kết thúc</th>
                        <th class="text-right">Thu nhập tháng</th>
                        <th class="text-right">Thu nhập năm</th>
                        <th class="text-left">Ghi chú</th>
                        <th class="text-center">Chỉnh sửa</th>
                    }
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Tổng</strong></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td class="text-right"><strong>@FormatUtility.DisplayThousandSeparatorsForNumber(Model.TotalMonthlyIncome)</strong></td>
                    <td class="text-right"><strong>@FormatUtility.DisplayThousandSeparatorsForNumber(Model.TotalMonthlyIncome * 12)</strong></td>
                    <td></td>
                    <td></td>
                </tr>
                @if (Model.List.Any())
                {
                    foreach (var item in Model.List)
                    {
                        <tr>
                            <td>@item.Name</td>
                            <td class="text-right">@FormatUtility.DisplayThousandSeparatorsForNumber(item.IncomeDay.Value)</td>
                            <td class="text-right">@item.StartDate.ToString("MM/yyyy")</td>
                            <td class="text-right">@(item.EndDate.HasValue ? item.EndDate.Value.ToString("MM/yyyy") : string.Empty)</td>
                            <td class="text-right">@FormatUtility.DisplayThousandSeparatorsForNumber(item.Value)</td>
                            <td class="text-right">@FormatUtility.DisplayThousandSeparatorsForNumber(item.Value * 12)</td>
                            <td>@item.Note</td>
                            <td class="text-center" width="160px">
                                <button class="btn btn-success update-income" data-income-id="@item.Id">
                                    <span class="glyphicon glyphicon-pencil"></span>
                                    Cập nhật
                                </button>
                                <button class="btn btn-danger delete-income" data-income-id="@item.Id">
                                    <span class="glyphicon glyphicon-remove"></span>
                                    Xóa
                                </button>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="8" class="text-center">Không có dữ liệu</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div class="income-modal">
    @{ Html.RenderPartial("_IncomeModal", new Incomes
        {
            IncomeType = Model.Type
        }); }
</div>

<div class="update-modal">

</div>


<script type="text/javascript" src="~/Scripts/income.js"></script>
<script type="text/javascript">
    var Url = new Object();
    Url.CreateIncome = '@Url.Action("CreateIncome", "Income")';
    Url.LoadTable = '@Url.Action("IncomeTable", "Income")';
    Url.LoadIncome = '@Url.Action("_IncomeUpdateModal", "Income")';
    Url.UpdateIncome = '@Url.Action("UpdateIncome", "Income")';
    Url.DeleteIncome = '@Url.Action("DeleteIncome", "Income")';
    var incomeType = @Model.Type;
</script>